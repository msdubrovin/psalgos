
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pypsalgos &#8212; psalgos-doc 1 documentation</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">psalgos-doc 1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pypsalgos</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#------------------------------</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on 2017-08-10 by Mikhail Dubrovin</span>

<span class="sd">Class provides access to C++ algorithms from python.</span>

<span class="sd">Usage::</span>

<span class="sd">    # IMPORT MISC</span>
<span class="sd">    # ===========</span>
<span class="sd">    import numpy as np</span>
<span class="sd">    from pyimgalgos.GlobalUtils import print_ndarr</span>

<span class="sd">    # INPUT PARAMETERS</span>
<span class="sd">    # ================</span>

<span class="sd">    shape = (32,185,388) # e.g.</span>
<span class="sd">    ave, rms = 200, 25</span>
<span class="sd">    data = np.array(ave + rms*np.random.standard_normal(shape), dtype=np.double)</span>
<span class="sd">    mask = np.ones(shape, dtype=np.uint16)</span>

<span class="sd">    #mask = det.mask()             # see class Detector.PyDetector</span>
<span class="sd">    #mask = np.loadtxt(fname_mask) # </span>

<span class="sd">    # 2-D IMAGE using cython object directly</span>
<span class="sd">    # ======================================</span>

<span class="sd">    import psalgos</span>

<span class="sd">    alg = psalgos.peak_finder_algos(seg=0, pbits=0)</span>
<span class="sd">    alg.set_peak_selection_parameters(npix_min=1, npix_max=None, amax_thr=0, atot_thr=0, son_min=6)</span>

<span class="sd">    peaks = alg.peak_finder_v3r3_d2(data, mask, rank=5, r0=7, dr=2, nsigm=5)</span>
<span class="sd">    peaks = alg.peak_finder_v4r3_d2(data, mask, thr_low=20, thr_high=50, rank=5, r0=7, dr=2)</span>

<span class="sd">    peaks = alg.list_of_peaks_selected()</span>
<span class="sd">    peaks_all = alg.list_of_peaks()</span>

<span class="sd">    p = algo.peak(0)</span>
<span class="sd">    p = algo.peak_selected(0)</span>

<span class="sd">    for p in peaks : print &#39;  row:%4d, col:%4d, npix:%4d, son::%4.1f&#39; % (p.row, p.col, p.npix, p.son)</span>
<span class="sd">    for p in peaks : print p.parameters()</span>

<span class="sd">    map_u2 = alg.local_maxima()</span>
<span class="sd">    map_u2 = alg.local_minima()</span>
<span class="sd">    map_u4 = alg.connected_pixels()</span>

<span class="sd">    import psalgos.pypsalgos as algos</span>

<span class="sd">    n = algos.local_minima_2d(data, mask, rank, extrema) # 0.019(sec) for shape=(1000, 1000) on psanaphi110</span>
<span class="sd">    n = algos.local_maxima_2d(data, mask, rank, extrema) # 0.019(sec)</span>
<span class="sd">    n = algos.local_maxima_rank1_cross_2d(data, mask, extrema) # 0.014(sec)</span>
<span class="sd">    n = algos.threshold_maxima_2d(data, mask, rank, thr_low, thr_high, extrema) # 0.0017(sec)</span>

<span class="sd">    # DIRECT CALL PEAKFINDERS</span>
<span class="sd">    # =======================</span>

<span class="sd">    from psalgos.pypsalgos import peaks_adaptive, peaks_droplet, peaks_adaptive_2d, peaks_droplet_2d</span>

<span class="sd">    # data and mask are 2-d numpy arrays of the same shape    </span>
<span class="sd">    peaks = peaks_adaptive_2d(data, mask, rank=5, r0=7.0, dr=2.0, nsigm=5, seg=0, npix_min=1, npix_max=None, amax_thr=0, atot_thr=0, son_min=8)</span>

<span class="sd">    peaks = peaks_droplet_2d(data, mask=None, thr_low, thr_high, rank=5, r0=7.0, dr=2.0, seg=0, npix_min=1, npix_max=None, amax_thr=0, atot_thr=0, son_min=8)</span>

<span class="sd">    # data and mask are N-d numpy arrays or list of 2-d numpy arrays of the same shape    </span>
<span class="sd">    peaks = peaks_adaptive(data, mask, rank=5, r0=7.0, dr=2.0, nsigm=3, npix_min=1, npix_max=None, amax_thr=0, atot_thr=0, son_min=8)</span>

<span class="sd">    # data and mask are N-d numpy arrays or list of 2-d numpy arrays of the same shape    </span>
<span class="sd">    peaks = peaks_droplet(data, mask=None, thr_low, thr_high, rank=5, r0=7.0, dr=2.0, npix_min=1, npix_max=None, amax_thr=0, atot_thr=0, son_min=8)</span>

<span class="sd">    peak_pars = list_of_peak_parameters(peaks)</span>


<span class="sd">    # Backward compatability support for ImgAlgos.PyAlgos</span>
<span class="sd">    # ===================================================</span>

<span class="sd">    # import:</span>
<span class="sd">    from psalgos.pypsalgos import PyAlgos # replacement for: from ImgAlgos.PyAlgos import PyAlgos</span>

<span class="sd">    # create object:</span>
<span class="sd">    alg = PyAlgos(mask=mask, pbits=0)</span>

<span class="sd">    # set peak-selector parameters:</span>
<span class="sd">    alg.set_peak_selection_pars(npix_min=1, npix_max=5000, amax_thr=0, atot_thr=0, son_min=8)</span>

<span class="sd">    # call peakfinders ATTENTION TO REVISION NUMBER: use r3 in stead of r2</span>

<span class="sd">    # v3 stands for &quot;ranker&quot; a.k.a. &quot;adaptive&quot;, r3 stands for revision </span>
<span class="sd">    peaks = alg.peak_finder_v3r3(nda, rank=2, r0=7.0, dr=2.0, nsigm=0) #, mask=...</span>

<span class="sd">    # v4 stands for &quot;droplet&quot; a.k.a. &quot;two threshold&quot;, r3 stands for revision</span>
<span class="sd">    peaks = alg.peak_finder_v4r3(nda, thr_low=10, thr_high=50, rank=5, r0=7.0, dr=2.0) #, mask=...</span>

<span class="sd">    # OPTIONAL for backward compatability</span>
<span class="sd">    # set mask</span>
<span class="sd">    alg.set_mask(mask)</span>

<span class="sd">    # set parameters for S/N evaluation algorithm</span>
<span class="sd">    alg.set_son_pars(r0=7, dr=2)</span>

<span class="sd">    # print info</span>
<span class="sd">    alg.print_attributes() # mask, r0, dr, peak selection parameters</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#------------------------------</span>
<span class="c1">#</span>
<span class="c1">#from pyimgalgos.GlobalUtils import print_ndarr</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">psalgos</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="shape_as_2d"><a class="viewcode-back" href="../index.html#pypsalgos.shape_as_2d">[docs]</a><span class="k">def</span> <span class="nf">shape_as_2d</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns 2-d shape for n-d shape if n&gt;2, otherwise returns unchanged shape.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">3</span> <span class="p">:</span> <span class="k">return</span> <span class="n">sh</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">size_from_shape</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span><span class="o">/</span><span class="n">sh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="shape_as_3d"><a class="viewcode-back" href="../index.html#pypsalgos.shape_as_3d">[docs]</a><span class="k">def</span> <span class="nf">shape_as_3d</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns 3-d shape for n-d shape if n&gt;3, otherwise returns unchanged shape.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">4</span> <span class="p">:</span> <span class="k">return</span> <span class="n">sh</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">size_from_shape</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span><span class="o">/</span><span class="n">sh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">sh</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">sh</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">sh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="reshape_to_2d"><a class="viewcode-back" href="../index.html#pypsalgos.reshape_to_2d">[docs]</a><span class="k">def</span> <span class="nf">reshape_to_2d</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns n-d re-shaped to 2-d</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape_as_2d</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">arr</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="reshape_to_3d"><a class="viewcode-back" href="../index.html#pypsalgos.reshape_to_3d">[docs]</a><span class="k">def</span> <span class="nf">reshape_to_3d</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns n-d re-shaped to 3-d</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape_as_3d</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">arr</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="local_minima_1d"><a class="viewcode-back" href="../index.html#pypsalgos.local_minima_1d">[docs]</a><span class="k">def</span> <span class="nf">local_minima_1d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">extrema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Finds local minima of specified rank in 1-d array of data with mask and returns results in array extrema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">extrema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>
    <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">local_minima_1d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">extrema</span><span class="p">)</span></div>

<span class="c1">#local_minimums_1d = local_minima_1d</span>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="local_maxima_1d"><a class="viewcode-back" href="../index.html#pypsalgos.local_maxima_1d">[docs]</a><span class="k">def</span> <span class="nf">local_maxima_1d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">extrema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Finds local maxima of specified rank in 1-d array of data with mask and returns results in array extrema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">extrema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>
    <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">local_maxima_1d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">extrema</span><span class="p">)</span></div>

<span class="c1">#local_maximums_1d = local_maxima_1d</span>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="local_minima_2d"><a class="viewcode-back" href="../index.html#pypsalgos.local_minima_2d">[docs]</a><span class="k">def</span> <span class="nf">local_minima_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">extrema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Finds local minima of specified rank in 2-d array of data with mask and returns results in array extrema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">extrema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>
    <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">local_minimums</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">extrema</span><span class="p">)</span></div>

<span class="c1">#local_minimums_2d = local_minima_2d</span>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="local_maxima_2d"><a class="viewcode-back" href="../index.html#pypsalgos.local_maxima_2d">[docs]</a><span class="k">def</span> <span class="nf">local_maxima_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">extrema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Finds local maxima of specified rank in 2-d array of data with mask and returns results in array extrema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">extrema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>
    <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">local_maximums</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">extrema</span><span class="p">)</span></div>

<span class="c1">#local_maximums_2d = local_maxima_2d</span>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="local_maxima_rank1_cross_2d"><a class="viewcode-back" href="../index.html#pypsalgos.local_maxima_rank1_cross_2d">[docs]</a><span class="k">def</span> <span class="nf">local_maxima_rank1_cross_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extrema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Finds local maxima rank=1 cross in 2-d array of data with mask and returns results in array extrema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">extrema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>
    <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">local_maximums_rank1_cross</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">extrema</span><span class="p">)</span></div>

<span class="c1">#local_maximums_rank1_cross_2d = local_maxima_rank1_cross_2d</span>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="threshold_maxima_2d"><a class="viewcode-back" href="../index.html#pypsalgos.threshold_maxima_2d">[docs]</a><span class="k">def</span> <span class="nf">threshold_maxima_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">thr_low</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thr_high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extrema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Finds local maxima using 2-threshold algorithm in 2-d array of data with mask and returns results in array extrema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">thr_low</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">thr_high</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">extrema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="p">:</span> <span class="k">return</span>
    <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">threshold_maximums</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">extrema</span><span class="p">)</span></div>

<span class="c1">#threshold_maximums_2d = threshold_maxima_2d</span>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="print_matrix_of_diag_indexes"><a class="viewcode-back" href="../index.html#pypsalgos.print_matrix_of_diag_indexes">[docs]</a><span class="k">def</span> <span class="nf">print_matrix_of_diag_indexes</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;Prints matrix of diagonal indexes for local_maxima_2d and local_minima_2d algorithms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">psalgos</span><span class="o">.</span><span class="n">print_matrix_of_diag_indexes</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="print_vector_of_diag_indexes"><a class="viewcode-back" href="../index.html#pypsalgos.print_vector_of_diag_indexes">[docs]</a><span class="k">def</span> <span class="nf">print_vector_of_diag_indexes</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;Prints vector of diagonal indexes for local_maxima_2d and local_minima_2d algorithms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">psalgos</span><span class="o">.</span><span class="n">print_vector_of_diag_indexes</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="peak_finder_alg_2d"><a class="viewcode-back" href="../index.html#pypsalgos.peak_finder_alg_2d">[docs]</a><span class="k">def</span> <span class="nf">peak_finder_alg_2d</span><span class="p">(</span><span class="n">seg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pbits</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates and returns algorithm object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">peak_finder_algos</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">pbits</span><span class="p">)</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="peaks_adaptive_2d"><a class="viewcode-back" href="../index.html#pypsalgos.peaks_adaptive_2d">[docs]</a><span class="k">def</span> <span class="nf">peaks_adaptive_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">nsigm</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>\
                      <span class="n">seg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">npix_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">npix_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amax_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atot_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">son_min</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Peak finder for 2-d numpy arrays of data and mask of the same shape</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#from time import time</span>

    <span class="c1">#t0_sec = time()</span>
    <span class="c1"># pbits NONE=0, DEBUG=1, INFO=2, WARNING=4, ERROR=8, CRITICAL=16</span>

    <span class="n">o</span> <span class="o">=</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">peak_finder_algos</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">pbits</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#377) # ~17 microsecond</span>
    <span class="n">_npix_max</span> <span class="o">=</span> <span class="n">npix_max</span> <span class="k">if</span> <span class="n">npix_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">o</span><span class="o">.</span><span class="n">set_peak_selection_parameters</span><span class="p">(</span><span class="n">npix_min</span><span class="p">,</span> <span class="n">_npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>
    <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>

    <span class="n">peaks</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">peak_finder_v3r3_d2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">nsigm</span><span class="p">)</span>

    <span class="c1">#print &#39;peak_finder_v3r3_d2: total time = %.6f(sec)&#39; % (time()-t0_sec)</span>
    <span class="c1">#print_ndarr(data,&#39;XXX:data&#39;)</span>
    <span class="c1">#print_ndarr(_mask,&#39;XXX:_mask&#39;)</span>

    <span class="k">return</span> <span class="n">peaks</span> <span class="c1"># or o.list_of_peaks_selected()</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="peaks_droplet_2d"><a class="viewcode-back" href="../index.html#pypsalgos.peaks_droplet_2d">[docs]</a><span class="k">def</span> <span class="nf">peaks_droplet_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thr_low</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thr_high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>\
                     <span class="n">seg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">npix_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">npix_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amax_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atot_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">son_min</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; peak finder for 2-d numpy arrays of data and mask of the same shape</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#from time import time</span>

    <span class="c1">#t0_sec = time()</span>
    <span class="c1"># pbits NONE=0, DEBUG=1, INFO=2, WARNING=4, ERROR=8, CRITICAL=16</span>

    <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">(</span><span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="n">o</span> <span class="o">=</span> <span class="n">psalgos</span><span class="o">.</span><span class="n">peak_finder_algos</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">pbits</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#377) # ~17 microsecond</span>
    <span class="n">_npix_max</span> <span class="o">=</span> <span class="n">npix_max</span> <span class="k">if</span> <span class="n">npix_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">o</span><span class="o">.</span><span class="n">set_peak_selection_parameters</span><span class="p">(</span><span class="n">npix_min</span><span class="p">,</span> <span class="n">_npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>
    <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>

    <span class="n">peaks</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">peak_finder_v4r3_d2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">)</span>

    <span class="c1">#print &#39;peak_finder_v3r3_d2: total time = %.6f(sec)&#39; % (time()-t0_sec)</span>
    <span class="c1">#print_ndarr(data,&#39;XXX:data&#39;)</span>
    <span class="c1">#print_ndarr(_mask,&#39;XXX:_mask&#39;)</span>

    <span class="k">return</span> <span class="n">peaks</span> <span class="c1"># or o.list_of_peaks_selected()</span></div>

<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="peaks_adaptive"><a class="viewcode-back" href="../index.html#pypsalgos.peaks_adaptive">[docs]</a><span class="k">def</span> <span class="nf">peaks_adaptive</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">nsigm</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>\
                   <span class="n">npix_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">npix_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amax_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atot_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">son_min</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Wrapper for liast of 2-d arrays or &gt;2-d arrays </span>
<span class="sd">       data and mask are N-d numpy arrays or list of 2-d numpy arrays of the same shape</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">peaks</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">seg</span><span class="p">,</span> <span class="n">d2d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">:</span>
                <span class="n">peaks</span> <span class="o">+=</span> <span class="n">peaks_adaptive_2d</span><span class="p">(</span><span class="n">d2d</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">nsigm</span><span class="p">,</span>\
                                           <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">seg</span><span class="p">,</span> <span class="p">(</span><span class="n">d2d</span><span class="p">,</span> <span class="n">m2d</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">mask</span><span class="p">))</span> <span class="p">:</span>
                <span class="n">peaks</span> <span class="o">+=</span> <span class="n">peaks_adaptive_2d</span><span class="p">(</span><span class="n">d2d</span><span class="p">,</span> <span class="n">m2d</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">nsigm</span><span class="p">,</span>\
                                           <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">peaks</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">2</span> <span class="p">:</span>
            <span class="n">seg</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">return</span> <span class="n">peaks_adaptive_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">nsigm</span><span class="p">,</span>\
                                     <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="o">&gt;</span><span class="mi">2</span> <span class="p">:</span>
            <span class="n">shape_in</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape_as_3d</span><span class="p">(</span><span class="n">shape_in</span><span class="p">)</span>
            <span class="n">peaks</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">data_in</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">data_in</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span>
                    <span class="n">peaks</span> <span class="o">+=</span> <span class="n">peaks_adaptive_2d</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">seg</span><span class="p">,:,:],</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">nsigm</span><span class="p">,</span>\
                                               <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
                <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span>
                    <span class="n">peaks</span> <span class="o">+=</span> <span class="n">peaks_adaptive_2d</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">seg</span><span class="p">,:,:],</span> <span class="n">mask</span><span class="p">[</span><span class="n">seg</span><span class="p">,:,:],</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">nsigm</span><span class="p">,</span>\
                                               <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>

                <span class="n">mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape_in</span>
            <span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape_in</span>
            <span class="k">return</span> <span class="n">peaks</span>

        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;pypsalgos.peak_finder_v3r3: wrong data.ndim </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>

    <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;pypsalgos.peak_finder_v3r3: unexpected object type for data: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="peaks_droplet"><a class="viewcode-back" href="../index.html#pypsalgos.peaks_droplet">[docs]</a><span class="k">def</span> <span class="nf">peaks_droplet</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>\
                  <span class="n">npix_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">npix_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amax_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atot_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">son_min</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Wrapper for liast of 2-d arrays or &gt;2-d arrays </span>
<span class="sd">       data and mask are N-d numpy arrays or list of 2-d numpy arrays of the same shape</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">peaks</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">seg</span><span class="p">,</span> <span class="n">d2d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">:</span>
                <span class="n">peaks</span> <span class="o">+=</span> <span class="n">peaks_droplet_2d</span><span class="p">(</span><span class="n">d2d</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span>\
                                          <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">seg</span><span class="p">,</span> <span class="p">(</span><span class="n">d2d</span><span class="p">,</span> <span class="n">m2d</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">mask</span><span class="p">))</span> <span class="p">:</span>
                <span class="n">peaks</span> <span class="o">+=</span> <span class="n">peaks_droplet_2d</span><span class="p">(</span><span class="n">d2d</span><span class="p">,</span> <span class="n">m2d</span><span class="p">,</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span>\
                                          <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">peaks</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">2</span> <span class="p">:</span>
            <span class="n">seg</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">return</span> <span class="n">peaks_droplet_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span>\
                                    <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="o">&gt;</span><span class="mi">2</span> <span class="p">:</span>
            <span class="n">shape_in</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape_as_3d</span><span class="p">(</span><span class="n">shape_in</span><span class="p">)</span>
            <span class="n">peaks</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">data_in</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">data_in</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span>
                    <span class="n">peaks</span> <span class="o">+=</span> <span class="n">peaks_droplet_2d</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">seg</span><span class="p">,:,:],</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span>\
                                              <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
                <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span>
                    <span class="n">peaks</span> <span class="o">+=</span> <span class="n">peaks_droplet_2d</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">seg</span><span class="p">,:,:],</span> <span class="n">mask</span><span class="p">[</span><span class="n">seg</span><span class="p">,:,:],</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span>\
                                              <span class="n">seg</span><span class="p">,</span> <span class="n">npix_min</span><span class="p">,</span> <span class="n">npix_max</span><span class="p">,</span> <span class="n">amax_thr</span><span class="p">,</span> <span class="n">atot_thr</span><span class="p">,</span> <span class="n">son_min</span><span class="p">)</span>

                <span class="n">mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape_in</span>
            <span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape_in</span>
            <span class="k">return</span> <span class="n">peaks</span>

        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;pypsalgos.peak_finder_v3r3: wrong data.ndim </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>

    <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;pypsalgos.peak_finder_v3r3: unexpected object type for data: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="list_of_peak_parameters"><a class="viewcode-back" href="../index.html#pypsalgos.list_of_peak_parameters">[docs]</a><span class="k">def</span> <span class="nf">list_of_peak_parameters</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Converts list of peak objects to the (old style) list of peak parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">]</span></div>

<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="PyAlgos"><a class="viewcode-back" href="../index.html#pypsalgos.PyAlgos">[docs]</a><span class="k">class</span> <span class="nc">PyAlgos</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Backward compatability support for ImgAlgos.PyAlgos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="PyAlgos.__init__"><a class="viewcode-back" href="../index.html#pypsalgos.PyAlgos.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pbits</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parameters</span>
<span class="sd">            - windows - is not used.</span>
<span class="sd">            - mask - numpy.array of the same shape as data or None.</span>
<span class="sd">            - pbits - level of verbosity bitword: NONE=0, DEBUG=1, INFO=2, WARNING=4, ERROR=8, CRITICAL=16</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r0</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dr</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_peak_selection_pars</span><span class="p">()</span></div>
        <span class="c1">#self.alg = psalgos.peak_finder_algos(seg, pbits)</span>


<div class="viewcode-block" id="PyAlgos.set_peak_selection_pars"><a class="viewcode-back" href="../index.html#pypsalgos.PyAlgos.set_peak_selection_pars">[docs]</a>    <span class="k">def</span> <span class="nf">set_peak_selection_pars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">npix_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">npix_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amax_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atot_thr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">son_min</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sets peak selection parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npix_min</span> <span class="o">=</span> <span class="n">npix_min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npix_max</span> <span class="o">=</span> <span class="n">npix_max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amax_thr</span> <span class="o">=</span> <span class="n">amax_thr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atot_thr</span> <span class="o">=</span> <span class="n">atot_thr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">son_min</span>  <span class="o">=</span> <span class="n">son_min</span></div>


<div class="viewcode-block" id="PyAlgos.peak_finder_v3r3"><a class="viewcode-back" href="../index.html#pypsalgos.PyAlgos.peak_finder_v3r3">[docs]</a>    <span class="k">def</span> <span class="nf">peak_finder_v3r3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nsigm</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;runs &quot;ranker&quot; peakfinder and returns the list of peak parameters.</span>

<span class="sd">        :param np.array data: n-d numpy array or list of 2-d numpy arrays of data </span>
<span class="sd">        :param int rank: radial size or the region [row-rank:row+rank, col-rank:col+rank] where central pixel is a local maximum</span>
<span class="sd">        :param float r0: radius [in pixels] of the ring for background evaluation</span>
<span class="sd">        :param float dr: width [in pixels] of the ring for background evaluation</span>
<span class="sd">        :param float nsigm: threshold on intensity to include pixel in connected group in terms of number of sigma (rms) estimated for pixels in the ring defined by r0 and dr</span>
<span class="sd">        :param np.array mask: mask uint16 shaped as data</span>
<span class="sd">        :return: list of tuple peak parameters (seg, row, col, npix, amp_max, amp_tot, row_cgrav, col_cgrav, row_sigma, col_sigma, row_min, row_max, col_min, col_max, bkgd, noise, son)</span>
<span class="sd">        :rtype: list of tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
        <span class="n">_r0</span> <span class="o">=</span> <span class="n">r0</span> <span class="k">if</span> <span class="n">r0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">r0</span>
        <span class="n">_dr</span> <span class="o">=</span> <span class="n">dr</span> <span class="k">if</span> <span class="n">dr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span>
        <span class="n">peaks</span> <span class="o">=</span> <span class="n">peaks_adaptive</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">_r0</span><span class="p">,</span> <span class="n">_dr</span><span class="p">,</span> <span class="n">nsigm</span><span class="p">,</span>\
                               <span class="bp">self</span><span class="o">.</span><span class="n">npix_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npix_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">amax_thr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atot_thr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">son_min</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_of_peak_parameters</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAlgos.peak_finder_v4r3"><a class="viewcode-back" href="../index.html#pypsalgos.PyAlgos.peak_finder_v4r3">[docs]</a>    <span class="k">def</span> <span class="nf">peak_finder_v4r3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">thr_low</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">thr_high</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;runs &quot;droplet-finder&quot; and returns the list of peak parameters.</span>

<span class="sd">        :param np.array data: n-d numpy array or list of 2-d numpy arrays of data </span>
<span class="sd">        :param float thr_low: low threshold [ADU] - used to include pixel in connected group and select pixels to estimate rms and mean in the ring</span>
<span class="sd">        :param float thr_high: high threshold [ADU] - used to search for local maxima candidate</span>
<span class="sd">        :param int rank: radial size or the region [row-rank, row+rank] where central pixel is a local maximum</span>
<span class="sd">        :param float r0: radius [in pixels] of the ring for background evaluation</span>
<span class="sd">        :param float dr: width [in pixels] of the ring for background evaluation</span>
<span class="sd">        :param np.array mask: mask uint16 shaped as data</span>
<span class="sd">        :return: list of tuple peak parameters (seg, row, col, npix, amp_max, amp_tot, row_cgrav, col_cgrav, row_sigma, col_sigma, row_min, row_max, col_min, col_max, bkgd, noise, son)</span>
<span class="sd">        :rtype: list of tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
        <span class="n">_r0</span> <span class="o">=</span> <span class="n">r0</span> <span class="k">if</span> <span class="n">r0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">r0</span>
        <span class="n">_dr</span> <span class="o">=</span> <span class="n">dr</span> <span class="k">if</span> <span class="n">dr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span>
        <span class="n">peaks</span> <span class="o">=</span> <span class="n">peaks_droplet</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_mask</span><span class="p">,</span> <span class="n">thr_low</span><span class="p">,</span> <span class="n">thr_high</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">_r0</span><span class="p">,</span> <span class="n">_dr</span><span class="p">,</span>\
                               <span class="bp">self</span><span class="o">.</span><span class="n">npix_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npix_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">amax_thr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atot_thr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">son_min</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_of_peak_parameters</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">set_son_pars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span> <span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r0</span> <span class="o">=</span> <span class="n">r0</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">dr</span> <span class="o">=</span> <span class="n">dr</span> 

    <span class="k">def</span> <span class="nf">set_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span>

    <span class="k">def</span> <span class="nf">set_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">winds</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">maps_of_maps_of_pixel_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="c1">#self.alg.... works for 2d only</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">maps_of_local_maximums</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="c1">#self.alg.... works for 2d only</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">maps_of_connected_pixels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="c1">#self.alg.... works for 2d only</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">print_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="nb">print</span> <span class="s1">&#39;mask    &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
        <span class="nb">print</span> <span class="s1">&#39;r0      &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r0</span>
        <span class="nb">print</span> <span class="s1">&#39;dr      &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span>
        <span class="nb">print</span> <span class="s1">&#39;npix_min&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npix_min</span>
        <span class="nb">print</span> <span class="s1">&#39;npix_max&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npix_max</span>
        <span class="nb">print</span> <span class="s1">&#39;amax_thr&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">amax_thr</span>
        <span class="nb">print</span> <span class="s1">&#39;atot_thr&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atot_thr</span>
        <span class="nb">print</span> <span class="s1">&#39;son_min &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">son_min</span> 

    <span class="k">def</span> <span class="nf">print_input_pars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_attributes</span><span class="p">()</span></div>

<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>
<span class="c1">#------------------------------</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span> <span class="p">:</span>
    <span class="nb">print</span> <span class="s1">&#39;See tests in examples, e.g.,</span><span class="se">\n</span><span class="s1">  python psalgos/examples/ex-02-localextrema.py 3&#39;</span>

<span class="c1">#------------------------------</span>
</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          
          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Mikhail Dubrovin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>